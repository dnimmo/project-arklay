var app=angular.module("projectMud",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/start"),e.state("start",{url:"/start",templateUrl:"views/start.html"}).state("inventory",{templateUrl:"views/inventory.html"}).state("setup",{url:"/setup",templateUrl:"views/setup.html"}).state("game",{url:"/game",templateUrl:"views/game.html"}).state("credits",{url:"/credits",templateUrl:"views/credits.html"})}]),app.factory("GameMapFactory",["$http",function(e){return{init:function(){return e.get("/rooms/start")},checkLocation:function(t){return e.get(t)}}}]),app.factory("GameItemFactory",[function(){var e=[];return{getInventory:function(){return e},add:function(t){return e.push(t),e},remove:function(t){var n=e.indexOf(t);return e.splice(n,1),e},use:function(e,t){var n=!1;return angular.forEach(t,function(t){t.link==e&&(t.blocked=!1,n=!0)}),n}}}]),app.factory("CreditsFactory",["$http",function(e){return{getCredits:function(){return e.get("/credits")}}}]),app.controller("MainCtrl",["$scope","GameMapFactory","GameItemFactory","CreditsFactory",function(e,t,n,r){e.inventoryOpen=!1,e.inventory=n.getInventory(),e.itemOptionsOpen=!1,e.showDescription=!1,e.additionalMessage="",e.visitedRooms=[],e.unlockedRooms=[],e.credits=[],t.init().then(function(t){e.current=t.data}),e.playerName,e.update=function(r){t.checkLocation(r).then(function(t){if(e.current=t.data,!e.current.gameOver&&(0!=e.unlockedRooms.length&&angular.forEach(e.current.directions,function(t){angular.forEach(e.unlockedRooms,function(e){t.link==e&&(t.blocked=!1)})}),"object"==typeof e.current.newItem)){var r=!1;angular.forEach(e.inventory,function(t){e.current.newItem.name==t.name&&(r=!0)}),angular.forEach(e.unlockedRooms,function(t){e.current.newItem.unlocks==t&&(r=!0)}),r||(n.add(e.current.newItem),e.inventory=n.getInventory())}})},e.registerPlayer=function(t){e.playerName=t},e.move=function(t){e.update(t),e.checkIfVisitedRoom(),e.additionalMessage=""},e.checkIfVisitedRoom=function(){var t=!1;angular.forEach(e.visitedRooms,function(n){n==e.current.name&&(t=!0)}),t||e.visitedRooms.push(e.current.name),console.log(e.visitedRooms)},e.showOptions=function(t){e.itemOptionsOpen=!0,e.selectedItem=t},e.clearSelectedItem=function(){e.selectedItem="",e.itemOptionsOpen=!1},e.discardItem=function(){n.remove(e.selectedItem),e.unlockedRooms.push(e.selectedItem.unlocks),e.clearSelectedItem()},e.use=function(){e.additionalMessage="";var t=n.use(e.selectedItem.unlocks,e.current.directions);t?e.discardItem():e.additionalMessage="You can't do that here"},e.getCredits=r.getCredits().then(function(t){e.credits=t.data.credits})}]);